<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Kalkulator Bimbru - Indywidualni uczestnicy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #2c3e50, #34495e);
      color: #ecf0f1;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 20px;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .header {
      text-align: center;
      padding: 20px;
      background-color: #34495e;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.4);
    }

    .header h1 {
      margin: 0;
      font-size: 26px;
    }

    .header p {
      margin: 5px 0 0 0;
      font-size: 14px;
      color: #bdc3c7;
    }

    .card {
      background-color: #2c3e50;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.4);
    }

    .card h2 {
      margin-top: 0;
      color: #3498db;
    }

    .form-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      margin-bottom: 10px;
      gap: 8px;
      font-size: 13px;
    }

    .form-row label {
      flex: 1 1 130px;
      font-weight: bold;
    }

    .form-row input,
    .form-row select {
      flex: 1 1 80px;
      padding: 5px 7px;
      font-size: 13px;
      border-radius: 4px;
      border: 1px solid #7f8c8d;
      text-align: center;
      background-color: #ecf0f1;
      color: #2c3e50;
    }

    .form-row input[type="checkbox"] {
      flex: 0 0 auto;
      width: auto;
      text-align: left;
    }

    .participants-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      gap: 10px;
    }

    .participants-header h2 {
      margin: 0;
    }

    .small-btn {
      padding: 6px 10px;
      font-size: 12px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      background-color: #27ae60;
      color: #ecf0f1;
    }

    .small-btn:hover {
      background-color: #1e8449;
    }

    .participant-card {
      background-color: #1f2a36;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 8px;
      border: 1px solid #34495e;
    }

    .participant-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .participant-header span {
      font-weight: bold;
    }

    .remove-btn {
      padding: 3px 7px;
      font-size: 11px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      background-color: #c0392b;
      color: #ecf0f1;
    }

    .remove-btn:hover {
      background-color: #922b21;
    }

    .hint {
      font-size: 11px;
      color: #bdc3c7;
      margin-top: 4px;
    }

    .grid-two {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 0.8fr);
      gap: 20px;
    }

    @media (max-width: 900px) {
      .grid-two {
        grid-template-columns: 1fr;
      }
    }

    .btn-main {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      font-weight: bold;
      background-color: #e74c3c;
      color: #ecf0f1;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.4);
      transition: background-color 0.2s, transform 0.1s;
    }

    .btn-main:hover {
      background-color: #c0392b;
    }

    .btn-main:active {
      transform: translateY(1px);
      box-shadow: 0 1px 4px rgba(0,0,0,0.4);
    }

    .results {
      font-family: "Courier New", monospace;
      white-space: pre-wrap;
      background-color: #1f2a36;
      border-radius: 10px;
      padding: 15px;
      color: #ecf0f1;
      margin-top: 10px;
      line-height: 1.6;
      font-size: 13px;
    }

    .footer {
      text-align: center;
      font-size: 12px;
      color: #95a5a6;
      padding: 10px 20px 20px 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üèîÔ∏è Kalkulator Bimbru ‚Äì Indywidualni uczestnicy</h1>
      <p>
        Ustaw docelowe promile dla ka≈ºdego uczestnika, a kalkulator policzy ile mo≈ºe piƒá
        i ile bimbru trzeba kupiƒá na ca≈ÇƒÖ ekipƒô. Program pisany w ramach ≈ºartu üòâ
      </p>
    </div>

    <div class="grid-two">
      <!-- LEWA: uczestnicy -->
      <div class="card">
        <div class="participants-header">
          <h2>üë• Uczestnicy</h2>
          <button class="small-btn" onclick="dodajUczestnika()">+ Dodaj uczestnika</button>
        </div>
        <div class="hint">
          Dla ka≈ºdego podaj: imiƒô, wagƒô, p≈Çeƒá, ile godzin pije w ciƒÖgu dnia i
          docelowe maksymalne promile (‚Ä∞), kt√≥re ‚Äûplanowo‚Äù chce mieƒá w szczycie formy.
          Je≈õli zaznaczysz tryb kierowcy ‚Äì kalkulator pilnuje, ≈ºeby nie przekroczyƒá 0.5‚Ä∞.
        </div>
        <div id="participantsContainer"></div>
      </div>

      <!-- PRAWA: ustawienia wyjazdu i koszty -->
      <div class="card">
        <h2>üìÖ Dane wyjazdu & üí∂ Koszty</h2>

        <div class="form-row">
          <label for="dni">Liczba dni (1‚Äì14):</label>
          <input type="number" id="dni" min="1" max="14" value="7" />
        </div>

        <div class="hint">
          Przyjmujemy bimber / w√≥dkƒô 40%. Liczenie jest poglƒÖdowe ‚Äì bardziej pod bekƒô ni≈º pod lekarza.
        </div>

        <hr style="border-color:#34495e; margin:15px 0;">

        <h3 style="margin-top:0;color:#f1c40f;">Ceny butelek (za sztukƒô)</h3>

        <div class="form-row">
          <label for="cena05">0.5 L (PLN):</label>
          <input type="number" id="cena05" min="0" step="0.1" value="30" />
        </div>

        <div class="form-row">
          <label for="cena07">0.7 L (PLN):</label>
          <input type="number" id="cena07" min="0" step="0.1" value="40" />
        </div>

        <div class="form-row">
          <label for="cena1">1.0 L (PLN):</label>
          <input type="number" id="cena1" min="0" step="0.1" value="50" />
        </div>

        <div class="form-row">
          <label for="kurs">Kurs PLN ‚Üí EUR (opcjonalnie):</label>
          <input type="number" id="kurs" min="0" step="0.01" value="4.5" />
        </div>

        <div class="hint">
          Koszty liczymy g≈Ç√≥wnie dla butelek 0.7L, ale poka≈ºemy te≈º ile wyjdzie na 0.5L i 1.0L.
        </div>
      </div>
    </div>

    <div class="card">
      <button class="btn-main" onclick="oblicz()">üßÆ OBLICZ WSZYSTKO</button>

      <div id="wyniki" class="results">
Dodaj uczestnik√≥w, ustaw dla ka≈ºdego docelowe promile i kliknij:
"OBLICZ WSZYSTKO".
      </div>
    </div>

    <div class="footer">
      ‚ö†Ô∏è Program humorystyczny ‚Äì nie traktuj tego jak porady medycznej.  
      Nie je≈∫d≈∫ na nartach/desce ani nie prowad≈∫ auta po alkoholu, nawet je≈õli ‚Äûkalkulator m√≥wi, ≈ºe siƒô da‚Äù. üéøüçª
    </div>
  </div>

  <script>
    let uczestnikId = 0;

    function domyslneImie(n) {
      const nazwy = ["Szef", "Bimbrownik", "Snowboardzista", "Narciarz", "Pilot", "Kierowca", "Absorber"];
      return nazwy[(n - 1) % nazwy.length] + " " + n;
    }

    function dodajUczestnika(preset) {
      const container = document.getElementById('participantsContainer');
      uczestnikId += 1;
      const id = uczestnikId;

      const card = document.createElement('div');
      card.className = 'participant-card';
      card.dataset.id = id;

      const header = document.createElement('div');
      header.className = 'participant-header';

      const title = document.createElement('span');
      title.textContent = "Uczestnik " + id;
      header.appendChild(title);

      const removeBtn = document.createElement('button');
      removeBtn.className = 'remove-btn';
      removeBtn.textContent = "Usu≈Ñ";
      removeBtn.onclick = () => card.remove();
      header.appendChild(removeBtn);

      card.appendChild(header);

      const form = document.createElement('div');

      form.innerHTML = `
        <div class="form-row">
          <label>Imiƒô / ksywka:</label>
          <input type="text" class="p-imie" value="${preset?.imie || domyslneImie(id)}" />
        </div>
        <div class="form-row">
          <label>Waga (kg):</label>
          <input type="number" class="p-waga" min="40" max="150" value="${preset?.waga || 75}" />
        </div>
        <div class="form-row">
          <label>P≈Çeƒá:</label>
          <select class="p-plec">
            <option value="mezczyzna"${preset?.plec === "kobieta" ? "" : " selected"}>Mƒô≈ºczyzna</option>
            <option value="kobieta"${preset?.plec === "kobieta" ? " selected" : ""}>Kobieta</option>
          </select>
        </div>
        <div class="form-row">
          <label>Picie dziennie (godziny):</label>
          <input type="number" class="p-godziny" min="1" max="24" value="${preset?.godziny || 8}" />
        </div>
        <div class="form-row">
          <label>Docelowe max promile (‚Ä∞):</label>
          <input type="number" class="p-cel" min="0.05" step="0.05" value="${preset?.cel || 0.5}" />
        </div>
        <div class="form-row">
          <label>Tryb kierowca (limit 0.5‚Ä∞)</label>
          <input type="checkbox" class="p-kierowca"${preset?.kierowca ? " checked" : ""} />
        </div>
      `;

      card.appendChild(form);
      container.appendChild(card);
    }

    // Start: przyk≈Çadowa ekipa
    dodajUczestnika({imie: "Szef", waga: 85, plec: "mezczyzna", godziny: 8, cel: 0.5, kierowca: false});
    dodajUczestnika({imie: "Deskarz", waga: 75, plec: "mezczyzna", godziny: 6, cel: 0.7, kierowca: false});
    dodajUczestnika({imie: "Kierowca", waga: 80, plec: "mezczyzna", godziny: 3, cel: 0.4, kierowca: true});

    function oblicz() {
      const dniInput = document.getElementById('dni');
      const cena05Input = document.getElementById('cena05');
      const cena07Input = document.getElementById('cena07');
      const cena1Input = document.getElementById('cena1');
      const kursInput = document.getElementById('kurs');
      const wynikiDiv = document.getElementById('wyniki');

      let liczbaDni = parseInt(dniInput.value, 10);
      if (isNaN(liczbaDni) || liczbaDni < 1) liczbaDni = 1;
      if (liczbaDni > 14) liczbaDni = 14;
      dniInput.value = liczbaDni;

      const cena05 = parseFloat(cena05Input.value) || 0;
      const cena07 = parseFloat(cena07Input.value) || 0;
      const cena1 = parseFloat(cena1Input.value) || 0;
      const kurs = parseFloat(kursInput.value) || 0;

      const procentAlkoholu = 40;
      const gestoscAlkoholu = 0.789;
      const spadekNaGodzine = 0.15;

      const participantCards = document.querySelectorAll('.participant-card');
      if (participantCards.length === 0) {
        wynikiDiv.textContent = "Dodaj przynajmniej jednego uczestnika ‚Äì inaczej nie ma komu piƒá.";
        return;
      }

      let raportUczestnicy = "";
      let sumaLitrowEkipa = 0;
      let maxBacGlobal = 0;
      let najgorszyUcz = null;
      let liczbaKierowcow = 0;

      participantCards.forEach((card, idx) => {
        const imie = card.querySelector('.p-imie').value || ("Uczestnik " + (idx + 1));
        const waga = parseFloat(card.querySelector('.p-waga').value);
        const plec = card.querySelector('.p-plec').value;
        const godziny = parseFloat(card.querySelector('.p-godziny').value);
        let cel = parseFloat(card.querySelector('.p-cel').value);
        const kierowca = card.querySelector('.p-kierowca').checked;

        if (!waga || !godziny || !cel || waga <= 0 || godziny <= 0 || cel <= 0) {
          raportUczestnicy += `*** ${imie}: co≈õ tu nie gra w danych (waga/godziny/promile) ‚Äì pomijam w obliczeniach.\n\n`;
          return;
        }

        let komentarzKierowca = "";
        if (kierowca) {
          liczbaKierowcow += 1;
          // twardy limit 0.5‚Ä∞ dla kierowcy
          if (cel > 0.5) {
            komentarzKierowca = "   ‚Üí Tryb kierowca: kalkulator ≈õciƒÖ≈Ç promile do 0.50‚Ä∞, bo kto≈õ musi was wywie≈∫ƒá z tych g√≥r.\n";
            cel = 0.5;
          } else {
            komentarzKierowca = "   ‚Üí Tryb kierowca: trzymamy siƒô limitu 0.5‚Ä∞ (w praktyce najlepiej 0.0‚Ä∞, ale kalkulator udaje, ≈ºe jest mi≈Çy).\n";
          }
        }

        const wspolczynnik = plec === 'mezczyzna' ? 0.68 : 0.55;

        const bacCel = cel;

        // g czystego alkoholu potrzebne do takiego BAC
        const alkoholGramy = bacCel * waga * wspolczynnik;

        // gramy -> litry w√≥dki 40%
        const mlCzysty = alkoholGramy / gestoscAlkoholu;
        const mlWodki = mlCzysty / (procentAlkoholu / 100);
        const litryNaDzien = mlWodki / 1000;

        const litryCalyWyjazd = litryNaDzien * liczbaDni;
        sumaLitrowEkipa += litryCalyWyjazd;

        const czasWytrzezwienia = bacCel / spadekNaGodzine;
        const bacKoniecDnia = Math.max(0, bacCel - spadekNaGodzine * godziny);

        if (bacCel > maxBacGlobal) {
          maxBacGlobal = bacCel;
          najgorszyUcz = imie;
        }

        let komentarzPoziom = "";
        if (bacCel >= 1.0) {
          komentarzPoziom = "   ‚Üí Poziom: HARDCORE. Teraz zaczyna siƒô prawdziwa jazda, ale lekarz by tego nie pochwali≈Ç.\n";
        } else if (bacCel >= 0.5) {
          komentarzPoziom = "   ‚Üí Poziom: VIP na stoku. Lepiej, ≈ºeby to by≈Ç tylko ≈ºart z kalkulatorem.\n";
        } else if (bacCel >= 0.3) {
          komentarzPoziom = "   ‚Üí Poziom: lekko weso≈Çy, ale nadal w miarƒô cywilizowany.\n";
        } else {
          komentarzPoziom = "   ‚Üí Poziom: grzeczny turysta, bardziej degustacja ni≈º demolka.\n";
        }

        raportUczestnicy +=
`‚ñ∫ ${imie} (${plec === "mezczyzna" ? "M" : "K"}, ${waga} kg${kierowca ? ", KIEROWCA" : ""})
   ‚Ä¢ Docelowe max promile: ${bacCel.toFixed(2)}‚Ä∞
   ‚Ä¢ Szacowana ilo≈õƒá bimbru 40%: ${litryNaDzien.toFixed(2)} L / dzie≈Ñ
   ‚Ä¢ Na ca≈Çy wyjazd (${liczbaDni} dni): ${litryCalyWyjazd.toFixed(2)} L
   ‚Ä¢ Picie dziennie: ${godziny.toFixed(1)} h
   ‚Ä¢ Orientacyjny czas do zej≈õcia z maksymalnej mocy: ~${czasWytrzezwienia.toFixed(1)} h
   ‚Ä¢ Promile na koniec dnia: ${bacKoniecDnia.toFixed(2)}‚Ä∞
${komentarzPoziom}${komentarzKierowca}
`;
      });

      const liczbaOsob = participantCards.length;

      const butelki05 = Math.ceil(sumaLitrowEkipa / 0.5);
      const butelki07 = Math.ceil(sumaLitrowEkipa / 0.7);
      const butelki1 = Math.ceil(sumaLitrowEkipa / 1.0);

      const koszt05 = butelki05 * cena05;
      const koszt07 = butelki07 * cena07;
      const koszt1 = butelki1 * cena1;

      const kosztGlow = koszt07;
      const kosztNaOsobeGlow = liczbaOsob > 0 ? kosztGlow / liczbaOsob : 0;
      const kosztGlowEur = kurs > 0 ? kosztGlow / kurs : 0;
      const kosztNaOsobeGlowEur = kurs > 0 ? kosztNaOsobeGlow / kurs : 0;

      let ostrzezenie = "";
      if (maxBacGlobal > 1.0) {
        ostrzezenie =
"\nüö® Kto≈õ ustawi≈Ç sobie poziom ‚Äûto ju≈º nie jest aperitif, to misja specjalna‚Äù (>1.0‚Ä∞).\n   Gratulujemy odwagi w kalkulatorze. Pamiƒôtajcie, ≈ºe organizm mo≈ºe mieƒá inne zdanie.";
      } else if (maxBacGlobal > 0.5) {
        ostrzezenie =
"\n‚ö†Ô∏è Ekipa celuje powy≈ºej 0.5‚Ä∞. To ju≈º jest tryb: ‚Äûpojazd zostawiamy pod domem, a na stok idziemy bardziej dla zdjƒôcia ni≈º dla slalomu‚Äù.";
      } else if (maxBacGlobal > 0.3) {
        ostrzezenie =
"\n‚ÑπÔ∏è Umiarkowany poziom weso≈Ço≈õci ‚Äì jeszcze da siƒô dyskutowaƒá, kto jutro pierwszy wstaje po bu≈Çki.";
      } else {
        ostrzezenie =
"\n‚úÖ WyglƒÖda na to, ≈ºe bardziej degustacja ni≈º totalna rozwa≈Çka. Instruktor narciarski by≈Çby dumny.";
      }

      let komentarzKierowcy = "";
      if (liczbaKierowcow > 0) {
        komentarzKierowcy =
`\nüöó Kierowcy w ekipie: ${liczbaKierowcow}
   Kalkulator pilnuje, ≈ºeby ≈ºaden z nich nie przekroczy≈Ç 0.5‚Ä∞ (w teorii).
   W praktyce najlepiej 0.0‚Ä∞, ale tu robimy sobie tylko ≈ºartobliwy plan.`;
      } else {
        komentarzKierowcy =
`\nüöó Brak oznaczonych kierowc√≥w.
   Czyli albo macie autobus z biura podr√≥≈ºy, albo jeszcze nie ustalili≈õcie, kto bƒôdzie ‚Äûtaks√≥wkƒÖ‚Äù.`;
      }

      const tekst = `
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë      KALKULATOR BIMBRU ‚Äì TRYB 2      ‚ïë
‚ïë  (docelowe promile ‚Üí ile piƒá & kupiƒá)‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üìÖ WYJAZD:
   ‚Ä¢ Liczba uczestnik√≥w: ${liczbaOsob}
   ‚Ä¢ Liczba dni: ${liczbaDni}

üë• UCZESTNICY ‚Äì PLAN PICIA (P√ì≈Å ≈ªARTEM, P√ì≈Å SERIO):

${raportUczestnicy}

üçª PODSUMOWANIE DLA CA≈ÅEJ EKIPY:
   ‚Ä¢ ≈ÅƒÖczna ilo≈õƒá bimbru 40% na ca≈Çy wyjazd: ${sumaLitrowEkipa.toFixed(2)} L

   ‚Ä¢ Butelki 0.5L: ${butelki05} szt.  (koszt: ${koszt05.toFixed(2)} PLN)
   ‚Ä¢ Butelki 0.7L: ${butelki07} szt.  (koszt: ${koszt07.toFixed(2)} PLN)
   ‚Ä¢ Butelki 1.0L: ${butelki1} szt.   (koszt: ${koszt1.toFixed(2)} PLN)

üí∂ KOSZTY (wariant 0.7L jako g≈Ç√≥wny):
   ‚Ä¢ Ca≈Çkowity koszt: ${kosztGlow.toFixed(2)} PLN${kurs > 0 ? `  (~${kosztGlowEur.toFixed(2)} EUR przy kursie ${kurs.toFixed(2)})` : ''}
   ‚Ä¢ Koszt na osobƒô: ${kosztNaOsobeGlow.toFixed(2)} PLN/osobƒô${kurs > 0 ? `  (~${kosztNaOsobeGlowEur.toFixed(2)} EUR)` : ''}

üè¥‚Äç‚ò†Ô∏è NAJMOCNIEJ ‚ÄûUSTAWIONY‚Äù Z GODZINNIKA:
   ‚Ä¢ Najwy≈ºsze docelowe promile: ${maxBacGlobal.toFixed(2)}‚Ä∞
   ‚Ä¢ Uczestnik: ${najgorszyUcz || "brak danych (wszyscy grzeczni)"}

${ostrzezenie}
${komentarzKierowcy}

üìå PAMIƒòTAJ:
   ‚Ä¢ Wszystko liczone orientacyjnie i dla ≈õmiechu.
   ‚Ä¢ Prawdziwe ≈ºycie, policja i lekarze nie korzystajƒÖ z tego kalkulatora (i mo≈ºe lepiej).
   ‚Ä¢ Jak kto≈õ ma byƒá kierowcƒÖ albo chce je≈∫dziƒá normalnie na stoku, to niech ustawia promile na 0.0‚Ä∞.
      `;

      wynikiDiv.textContent = tekst;
    }
  </script>
</body>
</html>
