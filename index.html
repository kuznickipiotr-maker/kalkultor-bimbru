<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Kalkulator Bimbru - Indywidualni uczestnicy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #2c3e50, #34495e);
      color: #ecf0f1;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 20px;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .header {
      text-align: center;
      padding: 20px;
      background-color: #34495e;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.4);
    }

    .header h1 {
      margin: 0;
      font-size: 26px;
    }

    .header p {
      margin: 5px 0 0 0;
      font-size: 14px;
      color: #bdc3c7;
    }

    .card {
      background-color: #2c3e50;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.4);
    }

    .card h2 {
      margin-top: 0;
      color: #3498db;
    }

    .form-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      margin-bottom: 10px;
      gap: 8px;
      font-size: 13px;
    }

    .form-row label {
      flex: 1 1 130px;
      font-weight: bold;
    }

    .form-row input,
    .form-row select {
      flex: 1 1 80px;
      padding: 5px 7px;
      font-size: 13px;
      border-radius: 4px;
      border: 1px solid #7f8c8d;
      text-align: center;
      background-color: #ecf0f1;
      color: #2c3e50;
    }

    .participants-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      gap: 10px;
    }

    .participants-header h2 {
      margin: 0;
    }

    .small-btn {
      padding: 6px 10px;
      font-size: 12px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      background-color: #27ae60;
      color: #ecf0f1;
    }

    .small-btn:hover {
      background-color: #1e8449;
    }

    .participant-card {
      background-color: #1f2a36;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 8px;
      border: 1px solid #34495e;
    }

    .participant-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .participant-header span {
      font-weight: bold;
    }

    .remove-btn {
      padding: 3px 7px;
      font-size: 11px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      background-color: #c0392b;
      color: #ecf0f1;
    }

    .remove-btn:hover {
      background-color: #922b21;
    }

    .hint {
      font-size: 11px;
      color: #bdc3c7;
      margin-top: 4px;
    }

    .grid-two {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 0.8fr);
      gap: 20px;
    }

    @media (max-width: 900px) {
      .grid-two {
        grid-template-columns: 1fr;
      }
    }

    .btn-main {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      font-weight: bold;
      background-color: #e74c3c;
      color: #ecf0f1;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.4);
      transition: background-color 0.2s, transform 0.1s;
    }

    .btn-main:hover {
      background-color: #c0392b;
    }

    .btn-main:active {
      transform: translateY(1px);
      box-shadow: 0 1px 4px rgba(0,0,0,0.4);
    }

    .results {
      font-family: "Courier New", monospace;
      white-space: pre-wrap;
      background-color: #1f2a36;
      border-radius: 10px;
      padding: 15px;
      color: #ecf0f1;
      margin-top: 10px;
      line-height: 1.6;
      font-size: 13px;
    }

    .footer {
      text-align: center;
      font-size: 12px;
      color: #95a5a6;
      padding: 10px 20px 20px 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üèîÔ∏è Kalkulator Bimbru ‚Äì Indywidualni uczestnicy</h1>
      <p>
        Ustaw docelowe promile dla ka≈ºdego uczestnika, a kalkulator policzy ile mo≈ºe piƒá
        i ile bimbru trzeba kupiƒá na ca≈ÇƒÖ ekipƒô. Program pisany w ramach ≈ºartu üòâ
      </p>
    </div>

    <div class="grid-two">
      <!-- LEWA: uczestnicy -->
      <div class="card">
        <div class="participants-header">
          <h2>üë• Uczestnicy</h2>
          <button class="small-btn" onclick="dodajUczestnika()">+ Dodaj uczestnika</button>
        </div>
        <div class="hint">
          Dla ka≈ºdego podaj: imiƒô, wagƒô, p≈Çeƒá, ile godzin pije w ciƒÖgu dnia i
          docelowe maksymalne promile (‚Ä∞), kt√≥re ‚Äûplanowo‚Äù chce mieƒá w szczycie formy.
        </div>
        <div id="participantsContainer"></div>
      </div>

      <!-- PRAWA: ustawienia wyjazdu i koszty -->
      <div class="card">
        <h2>üìÖ Dane wyjazdu & üí∂ Koszty</h2>

        <div class="form-row">
          <label for="dni">Liczba dni (1‚Äì14):</label>
          <input type="number" id="dni" min="1" max="14" value="7" />
        </div>

        <div class="hint">
          Przyjmujemy bimber / w√≥dkƒô 40%. Liczenie jest poglƒÖdowe ‚Äì bardziej pod bekƒô ni≈º pod lekarza.
        </div>

        <hr style="border-color:#34495e; margin:15px 0;">

        <h3 style="margin-top:0;color:#f1c40f;">Ceny butelek (za sztukƒô)</h3>

        <div class="form-row">
          <label for="cena05">0.5 L (PLN):</label>
          <input type="number" id="cena05" min="0" step="0.1" value="30" />
        </div>

        <div class="form-row">
          <label for="cena07">0.7 L (PLN):</label>
          <input type="number" id="cena07" min="0" step="0.1" value="40" />
        </div>

        <div class="form-row">
          <label for="cena1">1.0 L (PLN):</label>
          <input type="number" id="cena1" min="0" step="0.1" value="50" />
        </div>

        <div class="form-row">
          <label for="kurs">Kurs PLN ‚Üí EUR (opcjonalnie):</label>
          <input type="number" id="kurs" min="0" step="0.01" value="4.5" />
        </div>

        <div class="hint">
          Koszty liczymy g≈Ç√≥wnie dla butelek 0.7L, ale poka≈ºemy te≈º ile wyjdzie na 0.5L i 1.0L.
        </div>
      </div>
    </div>

    <div class="card">
      <button class="btn-main" onclick="oblicz()">üßÆ OBLICZ WSZYSTKO</button>

      <div id="wyniki" class="results">
Dodaj uczestnik√≥w, ustaw dla ka≈ºdego docelowe promile i kliknij:
"OBLICZ WSZYSTKO".
      </div>
    </div>

    <div class="footer">
      ‚ö†Ô∏è Program humorystyczny ‚Äì nie traktuj tego jak porady medycznej.  
      Nie je≈∫d≈∫ na nartach/desce ani nie prowad≈∫ auta po alkoholu, nawet je≈õli ‚Äûkalkulator m√≥wi, ≈ºe siƒô da‚Äù. üéøüçª
    </div>
  </div>

  <script>
    let uczestnikId = 0;

    function domyslneImie(n) {
      const nazwy = ["Szef", "Bimbrownik", "Snowboardzista", "Narciarz", "Pilot", "Kierowca", "Absorber"];
      return nazwy[(n - 1) % nazwy.length] + " " + n;
    }

    function dodajUczestnika(preset) {
      const container = document.getElementById('participantsContainer');
      uczestnikId += 1;
      const id = uczestnikId;

      const card = document.createElement('div');
      card.className = 'participant-card';
      card.dataset.id = id;

      const header = document.createElement('div');
      header.className = 'participant-header';

      const title = document.createElement('span');
      title.textContent = "Uczestnik " + id;
      header.appendChild(title);

      const removeBtn = document.createElement('button');
      removeBtn.className = 'remove-btn';
      removeBtn.textContent = "Usu≈Ñ";
      removeBtn.onclick = () => card.remove();
      header.appendChild(removeBtn);

      card.appendChild(header);

      const form = document.createElement('div');

      form.innerHTML = `
        <div class="form-row">
          <label>Imiƒô / ksywka:</label>
          <input type="text" class="p-imie" value="${preset?.imie || domyslneImie(id)}" />
        </div>
        <div class="form-row">
          <label>Waga (kg):</label>
          <input type="number" class="p-waga" min="40" max="150" value="${preset?.waga || 75}" />
        </div>
        <div class="form-row">
          <label>P≈Çeƒá:</label>
          <select class="p-plec">
            <option value="mezczyzna"${preset?.plec === "kobieta" ? "" : " selected"}>Mƒô≈ºczyzna</option>
            <option value="kobieta"${preset?.plec === "kobieta" ? " selected" : ""}>Kobieta</option>
          </select>
        </div>
        <div class="form-row">
          <label>Picie dziennie (godziny):</label>
          <input type="number" class="p-godziny" min="1" max="24" value="${preset?.godziny || 8}" />
        </div>
        <div class="form-row">
          <label>Docelowe max promile (‚Ä∞):</label>
          <input type="number" class="p-cel" min="0.05" step="0.05" value="${preset?.cel || 0.5}" />
        </div>
      `;

      card.appendChild(form);
      container.appendChild(card);
    }

    // Start: przyk≈Çadowa ekipa
    dodajUczestnika({imie: "Szef", waga: 85, plec: "mezczyzna", godziny: 8, cel: 0.5});
    dodajUczestnika({imie: "Deskarz", waga: 75, plec: "mezczyzna", godziny: 6, cel: 0.7});
    dodajUczestnika({imie: "Narciarka", waga: 60, plec: "kobieta", godziny: 5, cel: 0.4});

    function oblicz() {
      const dniInput = document.getElementById('dni');
      const cena05Input = document.getElementById('cena05');
      const cena07Input = document.getElementById('cena07');
      const cena1Input = document.getElementById('cena1');
      const kursInput = document.getElementById('kurs');
      const wynikiDiv = document.getElementById('wyniki');

      let liczbaDni = parseInt(dniInput.value, 10);
      if (isNaN(liczbaDni) || liczbaDni < 1) liczbaDni = 1;
      if (liczbaDni > 14) liczbaDni = 14;
      dniInput.value = liczbaDni;

      const cena05 = parseFloat(cena05Input.value) || 0;
      const cena07 = parseFloat(cena07Input.value) || 0;
      const cena1 = parseFloat(cena1Input.value) || 0;
      const kurs = parseFloat(kursInput.value) || 0;

      const procentAlkoholu = 40;
      const gestoscAlkoholu = 0.789;
      const spadekNaGodzine = 0.15;

      const participantCards = document.querySelectorAll('.participant-card');
      if (participantCards.length === 0) {
        wynikiDiv.textContent = "Dodaj przynajmniej jednego uczestnika ‚Äì inaczej nie ma komu piƒá.";
        return;
      }

      let raportUczestnicy = "";
      let sumaLitrowEkipa = 0;
      let maxBacGlobal = 0;
      let najgorszyUcz = null;

      participantCards.forEach((card, idx) => {
        const imie = card.querySelector('.p-imie').value || ("Uczestnik " + (idx + 1));
        const waga = parseFloat(card.querySelector('.p-waga').value);
        const plec = card.querySelector('.p-plec').value;
        const godziny = parseFloat(card.querySelector('.p-godziny').value);
        const cel = parseFloat(card.querySelector('.p-cel').value);

        if (!waga || !godziny || !cel || waga <= 0 || godziny <= 0 || cel <= 0) {
          raportUczestnicy += `*
